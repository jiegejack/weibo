//
//  PCDScanView.h
//  PCDKit
//
//  Created by wangyong on 16/4/20.
//  Copyright © 2016年 P&C Information. All rights reserved.
//

#import <UIKit/UIKit.h>
#import <AVFoundation/AVFoundation.h>
#import <ImageIO/ImageIO.h>

@protocol PCDScanViewDelegate;

/**
 *  @brief 二维码、条形码扫描功能视图
 */
@interface PCDScanView : UIView

/**
 *  @brief 代理
 */
@property(nonatomic,assign) IBOutlet id <PCDScanViewDelegate> delegate;

/**
 *  @brief 闪关灯开关，默认关
 */
@property(nonatomic,assign) BOOL cameraTorchMode;

/**
 是否需要返回摄像机信息，默认NO
 */
@property(nonatomic,assign) BOOL cameraSample;

/**
 设置扫描区域，用法同AVCaptureMetadataOutput的rectOfInterest属性
 */
@property(nonatomic,assign) CGRect rectOfInterest;

/**
 *  @brief 开始扫描
 */
-(void)startRuning;

/**
 *  @brief 结束扫描
 */
-(void)stopRuning;

/**
 调用系统的相册

 @param parentVC 父级控制器
 @param yesOrNo 是否需要编辑
 */
-(void)showPhotoAlbumWithController:(UIViewController *)parentVC allowsEditing:(BOOL)yesOrNo;

/**
 *  @brief 摄像头旋转，默认UIInterfaceOrientationPortrait
 *
 *  @param orientation 旋转方向
 *  @param duration    动画时间
 */
- (void)willRotateToInterfaceOrientation: (UIInterfaceOrientation)orientation duration: (NSTimeInterval) duration;

@end

@protocol PCDScanViewDelegate <NSObject>

/**
 *  扫描失败代理
 *
 *  @param scanView 实例化的scanView
 *  @param error    错误信息 999:无相机权限 888:扫描出但未解析到结果
 */
-(void)scanView:(PCDScanView *)scanView didFailScanWithError:(NSError *)error;

/**
 *  扫描成功代理
 *
 *  @param scanView     实例化的scanView
 *  @param resultString 扫描结果信息
 */
-(void)scanView:(PCDScanView *)scanView didFinishScan:(NSString *)resultString;

@optional
/**
 当前摄像头信息回调

 @param scanView 实例化的scanView
 @param cameraInfo 摄像头信息
 */
-(void)scanView:(PCDScanView *)scanView didOutputSampleBuffer:(NSDictionary *)cameraInfo;

@end
