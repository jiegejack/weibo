//
//  JSTabBarController.m
//  JSBankCCYRemastered
//
//  Created by Jack on 2019/4/11.
//  Copyright © 2019 Jack. All rights reserved.
//

#import "JSTabBarController.h"
#import "JSHomeViewController.h"
#import "JSFinancialViewController.h"
#import "JSCardLifeViewController.h"
#import "JSMineViewController.h"
#import "CTMediator.h"
#import "CTMediator+CTMediatorModuleActions.h"
#import "JSBaseWebViewController.h"

@interface JSTabBarController ()
@property(nonatomic,strong) UINavigationController *nav0,*nav1,*nav3,*nav4;

@end

@implementation JSTabBarController

- (void)viewDidLoad {
    [super viewDidLoad];
    
    [self addObserver:self forKeyPath:@"viewControllers" options:NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld context:nil];
    
    [self initViewControllers];
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey,id> *)change context:(void *)context {
    if (![JSSharedInstance sharedInstance].viewControllers.count) {
        [JSSharedInstance sharedInstance].viewControllers = self.viewControllers;
        [self removeObserver:self forKeyPath:@"viewControllers"];
    }
}

- (void)initTabBar {
    [super initTabBar];
    
    self.tabBarHeight = 53;
    self.bottomHeight = 53;
    
    self.tabBar.separatorWidth = 0.5;
    self.tabBar.separatorColor = [UIColor groupTableViewBackgroundColor];

    UIColor *titleColorHL = [UIColor blackColor];
    CGSize imageSize = CGSizeMake(25, 25);
    
    PCDTabBarItem *item0 = [[PCDTabBarItem alloc] initWithTitle:@"首页" image:[UIImage imageNamed:@"精选"] selectedImage:[UIImage imageNamed:@"精选hover"]];
    item0.titleInsets =UIEdgeInsetsMake(6, 0, 5, 0);
    item0.titleColorHL =titleColorHL;
    item0.imageSize = imageSize;
    item0.font = [UIFont systemFontOfSize:12];
    
    PCDTabBarItem *item1 = [[PCDTabBarItem alloc] initWithTitle:@"卡金融" image:[UIImage imageNamed:@"金融"] selectedImage:[UIImage imageNamed:@"金融hover"]];
    item1.titleInsets = UIEdgeInsetsMake(6, 0, 5, 0);
    item1.titleColorHL = titleColorHL;
    item1.imageSize = imageSize;
    item1.font = [UIFont systemFontOfSize:12];
    
    PCDTabBarItem *item3 = [[PCDTabBarItem alloc] initWithTitle:@"我的" image:[UIImage imageNamed:@"我的"] selectedImage:[UIImage imageNamed:@"我的hover"]];
    item3.imageSize = imageSize;
    item3.titleInsets =UIEdgeInsetsMake(6, 0, 5, 0);
    item3.titleColorHL =titleColorHL;
    item3.font = [UIFont systemFontOfSize:12];
    
    self.tabBar.items =@[item0,item1,item3];
}
//@"http://66.0.245.74:8081/ares-web-h5/page/client.html#page/102/01/P10201.html";//[PCDUtil getServerURL:@"102/01/P10201.html"];
//@"http://66.0.245.212:8081/ares-web-h5/page/client.html#page/PP01/PP0104/PP0104.html"
- (void)initViewControllers {
    NSDictionary *expando = [PCDUtil IsIphoneX]?@{@"NSLayoutAttributeTop":@"88"}:@{@"NSLayoutAttributeTop":@"64"};

    NSString *url = @"";
    JSHomeViewController *homeVC = [PCDWServiceGet() createPCDViewController:@{@"url":url} viewControllerClass:[JSHomeViewController class] contentViewClass:nil withExpando:(NSDictionary *)expando];
    homeVC.requestUrl = url;
    self.nav0 = [[UINavigationController alloc] initWithRootViewController:homeVC];
    
    JSFinancialViewController *financialVC = [PCDWServiceGet() createPCDViewController:@{@"url":[PCDUtil getServerURL:Server_FindPage_URL]} viewControllerClass:[JSFinancialViewController class] contentViewClass:nil withExpando:(NSDictionary *)expando];
    financialVC.requestUrl = [PCDUtil getServerURL:Server_FindPage_URL];
    self.nav1 = [[UINavigationController alloc] initWithRootViewController:financialVC];
    
    
    JSMineViewController *mineVC = [PCDWServiceGet() createPCDViewController:@{@"url":[PCDUtil getServerURL:Server_MinePage_URL]} viewControllerClass:[JSMineViewController class] contentViewClass:nil withExpando:(NSDictionary *)expando];
    mineVC.requestUrl = [PCDUtil getServerURL:Server_MinePage_URL];
    self.nav3 = [[UINavigationController alloc] initWithRootViewController:mineVC];
    
    self.viewControllers = @[_nav0,_nav1,_nav3];
    self.selectedIndex=0;
}

@end
