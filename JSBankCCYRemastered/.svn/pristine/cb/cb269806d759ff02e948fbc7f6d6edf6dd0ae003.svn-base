//
//  ClientLocation.m
//  JSBankCCYRemastered
//
//  Created by Jack on 2019/6/18.
//  Copyright © 2019 Jack. All rights reserved.
//

#import "ClientLocation.h"
#import "LocationManager.h"

@implementation ClientLocation

- (void)handler:(id)data andContext:(PCDContext *)context ResponseCallback:(WVJBResponseCallback )responseCallback {
    NSDictionary *dict = (NSDictionary *)data;
    NSString *callback = [dict objectForKey:@"callback"];
    callback = callback.notNull ? callback : @"";

    NSLog(@"调用了定位");
    if ([JSSharedInstance sharedInstance].locationDict.notNull) {
        NSDictionary *dic = [JSSharedInstance sharedInstance].locationDict;
        evaluateJavaScriptOnMainThread_quotes(self, callback, [dic JSONRepresentation]);
        return;
    }
    [[LocationManager shareInstance] locationComplete:^(NSDictionary * _Nonnull location) {
        NSLog(@"location : %@",location);
        evaluateJavaScriptOnMainThread_quotes(self, callback, [location JSONRepresentation]);
    }];
}

@end
