//
//  JSCheckBox.m
//  JSBankCCYRemastered
//
//  Created by Jack on 2019/4/17.
//  Copyright Â© 2019 Jack. All rights reserved.
//

#import "JSCheckBox.h"

@interface JSCheckBox ()
@property (nonatomic, copy)NSString *key;
@end
@implementation JSCheckBox

- (id)initWithButton_key:(NSString *)key {
    if (self = [super init]) {
        self.key = key;
        self.adjustsImageWhenHighlighted = NO;
        self.imageView.contentMode = UIViewContentModeScaleAspectFit;
        [self addTarget:self action:@selector(action:) forControlEvents:UIControlEventTouchUpInside];
    }
    return self;
}

- (CGRect)imageRectForContentRect:(CGRect)contentRect {
    CGFloat X = 0;
    CGFloat H = contentRect.size.height;
    CGFloat W = H;
    CGFloat Y = (contentRect.size.height - H) / 2;
    
    return CGRectMake(X, Y, W, H);
}

- (CGRect)titleRectForContentRect:(CGRect)contentRect {
    CGFloat margin = 6;
    CGFloat H = 16;
    CGFloat Y = (contentRect.size.height - H) / 2;
    CGFloat X = contentRect.size.height + margin;
    CGFloat W = contentRect.size.width - X - margin;
    
    return CGRectMake(X, Y, W, H);
}

- (void)setSelectedImageName:(NSString *)selectedImageName {
    _selectedImageName = selectedImageName;
    
    if (selectedImageName.notNull && self.isSelectedBox) {
        [self setImage:[UIImage imageNamed:selectedImageName] forState:UIControlStateNormal];
    }
}

- (void)setImageName:(NSString *)imageName {
    _imageName = imageName;
    
    if (imageName.notNull && !self.isSelectedBox) {
        [self setImage:[UIImage imageNamed:imageName] forState:UIControlStateNormal];
    }
}

- (void)setSelected:(BOOL)selected {
    [super setSelected:selected];
    NSLog(@"button--- %@",NSStringFromClass([self class]));
    
    [DataCache setCacheString:selected ? @"1" : @"0" forkey:self.key.notNull ? self.key : @""];
}

- (BOOL)isSelectedBox {
    BOOL selected = [[DataCache getCacheStringForkey:self.key.notNull ? self.key : @""] boolValue];

    return selected;
}

- (void)action:(UIButton *)button {
    button.selected = !self.isSelectedBox;
    [self setImage:[UIImage imageNamed:button.selected ? _selectedImageName : _imageName] forState:UIControlStateNormal];
}

//- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
//    if (CGPointEqualToPoint(self.point, CGPointZero)) {
//        return NO;
//    }
//    NSLog(@"----self.point : %@",NSStringFromCGPoint(self.point));
//    NSLog(@"point : %@",NSStringFromCGPoint(point));
//    NSLog(@"self.frame : %@",NSStringFromCGRect(self.frame));
//
//    CGRect rect = CGRectMake(self.frame.origin.x - self.point.x, self.frame.origin.y - self.point.y, self.frame.size.width + 2 * self.point.x, self.frame.size.height + 2 * self.point.y);
//    NSLog(@"frame : %@",NSStringFromCGRect(rect));
//
//    if (CGRectContainsPoint(rect, point)) {
//        return YES;
//    }
//
//    return NO;
//}
@end
