//
//  PCShareModel.m
//  PNCMobileBank
//
//  Created by Mac-陶(tzw) on 2018/3/6.
//  Copyright © 2018年 MacBook-陶(tzw). All rights reserved.
//

#import "PCShareModel.h"
#import <ShareSDK/ShareSDK+Base.h>


@implementation PCShareModel

+(void)shareContentWithTitle:(NSString *)title
                     Message:(NSString *)msg
                       Image:(UIImage *)img
                         Url:(NSString *)url
                   ShareType:(SSDKContentType)type
                SuccessBlock:(void(^)(BOOL ret,NSString *msg))sucBlock
                 FailedBlock:(void(^)(BOOL ret,NSString *msg))failBlock {
    
    NSString *ver = [ShareSDK sdkVersion];
    
    ver = [ver stringByReplacingOccurrencesOfString:@"." withString:@""];

    NSMutableDictionary *shareParams = [NSMutableDictionary dictionary];
    NSArray * imgArr = @[img];
    
    [shareParams SSDKSetupShareParamsByText:msg images:imgArr url:[NSURL URLWithString:url] title:title type:type];
    
    NSMutableArray *tempArray = [[NSMutableArray alloc] init];
    [tempArray addObject:@(SSDKPlatformSubTypeWechatSession)];
    [tempArray addObject:@(SSDKPlatformSubTypeQQFriend)];
    [tempArray addObject:@(SSDKPlatformTypeMail)];
    [tempArray addObject:@(SSDKPlatformSubTypeWechatTimeline)];

    //有的平台要客户端分享需要加此方法，例如微博
    [shareParams SSDKEnableUseClientShare];
    //2、分享（可以弹出我们的分享菜单和编辑界面）
    
    [ShareSDK showShareActionSheet:nil customItems:nil shareParams:shareParams sheetConfiguration:nil onStateChanged:^(SSDKResponseState state, SSDKPlatformType platformType, NSDictionary *userData, SSDKContentEntity *contentEntity, NSError *error, BOOL end) {
        switch (state) {
            case SSDKResponseStateSuccess:
            {
                sucBlock(YES,@"分享成功");
                break;
            }
            case SSDKResponseStateFail:
            {
                failBlock(NO,@"分享失败");
                break;
            }
            default:
                break;
        }
    }];
    
}

@end
