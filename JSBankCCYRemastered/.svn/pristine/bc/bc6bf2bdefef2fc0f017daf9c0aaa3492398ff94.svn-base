//
//  PCDEncrypt.h
//  testDemo
//
//  Created by 张瑞 on 16/4/21.
//  Copyright © 2016年 张瑞. All rights reserved.
//

#import <Foundation/Foundation.h>

#import "PCDEnCryptDo.h"


/**
 *  @brief 加解密处理类
 */
@interface PCDEncrypt : NSObject


/**
 用于请求token的key
 */
@property (nonatomic,copy) NSString *randomKey;

/**
 握手请求到的token 用作三段式最后一段 (v2加密方式)
 */
@property (nonatomic,copy) NSString *token;


/**
 *  @brief 获取加密类对象
 *
 *  @return 返回PCDEncrypt
 */
+ (nonnull instancetype)sharedEncrypt;


/**
 *  @brief 参数对象
 *
 */

@property(nonnull,nonatomic,retain) PCDEnCryptDo *CryptDo;


/**
 *  @brief 获取三段式(MD5+AES+RSA)加密后密文
 *
 *  @param aString 待加密明文
 *  @param aKey 密钥
 *
 *  @return 加密结果
 */
-(nonnull NSString *)getCryptString:(nonnull NSString *)aString withKey:(NSString **)aKey;

/**
 *  @brief -新增实时获取token的三段式加密(v2)
 *
 *  @param aString 待加密明文
 *  @param aKey 密钥
 *
 *  @return 加密结果
 */
- (nonnull NSString *)getCryptStringVer2:(NSString *)aString withKey:(NSString *__autoreleasing *)aKey;

/**
 *  @brief  获取三段式(SM3+SM4+SM2)加密后密文
 *
 *  @param aString 待加密明文
 *  @param aKey    密钥
 *
 *  @return 加密结果
 */
-(nonnull NSString *)getSMCryptString:(nonnull NSString *)aString withKey:(NSString **)aKey;

/**
 *  @brief  获取SM4解密字符串
 *
 *  @param bytes 密文
 *  @param aKey    秘钥
 *  @param length  长度
 *
 *  @return 明文
 */
-(nonnull NSString *)getSMDecryptString:(nonnull unsigned char *)bytes withKey:(nonnull NSString *)aKey length:(int)length;

/**
 *  @brief AES加密
 *
 *  @param aString 待加密明文
 *  @param aKey 密钥
 *
 *  @return 密文
 */
-(nonnull NSString *)encryptString:(nonnull NSString *)aString withAESKey:(nonnull NSString *)aKey;

/**
 *  @brief AES解密
 *
 *  @param aString 待解密密文
 *  @param aKey aKey 密钥
 *
 *  @return 明文
 */
-(nonnull NSString *)decryptString:(nonnull NSString *)aString withAESKey:(nonnull NSString *)aKey;

/**
 *  @brief AES加密
 *
 *  @param aString 待加密明文
 *  @param aKey    秘钥
 *  @param iv      偏移量
 *
 *  @return 密文
 */
-(nonnull NSString *)encryptString:(nonnull NSString *)aString withAESKey:(nonnull NSString *)aKey vector:(nonnull NSString *)iv;

/**
 *  @brief AES解密
 *
 *  @param aString 待解密密文
 *  @param aKey    秘钥
 *  @param iv      偏移量
 *
 *  @return 明文
 */
-(nonnull NSString *)decryptString:(nonnull NSString *)aString withAESKey:(nonnull NSString *)aKey vector:(nonnull NSString *)iv;

/**
 *  @brief sm2加密
 *
 *  @param aString    待加密内容
 *  公钥x、y轴坐标默认非配置
 *  @return 加密结果
 */
-(nonnull NSString *)sm2EncryptString:(nonnull NSString *)aString;

/**
 *  @brief sm2加密
 *
 *  @param aString    待加密内容
 *  @param publicKeyX 公钥x轴坐标
 *  @param publicKeyY 公钥y轴坐标
 *
 *  @return 加密结果
 */
-(nonnull NSString *)sm2EncryptString:(nonnull NSString *)aString withPublicKeyX:(nonnull NSString *)publicKeyX publicKeyY:(nonnull NSString *)publicKeyY;

/**
 *  @brief sm3加密
 *
 *  @param aString 待加密内容
 *
 *  @return 加密结果
 */
-(nonnull NSString *)sm3EncryptString:(nonnull NSString *)aString;

/**
 *  @brief sm4加密
 *
 *  @param aString 待加密内容
 *  @param key     加密因子
 *
 *  @return 加密结果
 */
-(nonnull NSString *)sm4EncryptString:(nonnull NSString *)aString withKey:(nonnull NSString *)key;

/**
 *  @brief sm4解密
 *
 *  @param aString 待解密内容
 *  @param key     解密因子
 *
 *  @return 解密结果
 */
-(nonnull NSString *)sm4DecryptString:(nonnull NSString *)aString withKey:(nonnull NSString *)key;



/**
 3des 加密

 @param aString 待加密内容
 @return 加密结果
 */
- (nonnull NSString *)des3EncryptString:(nonnull NSString *)aString;


/**
 3des解密

 @param aString 密文
 @return 解密结果
 */
- (nonnull NSString *)des3DecyptString:(nonnull NSString *)aString;


/**
 RSA加密

 @param aString 待加密数据
 @return 加密后数据
 */
-(nonnull NSString *)rsaEncryptString:(nonnull NSString *)aString;
@end
